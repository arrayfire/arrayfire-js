{"version":3,"sources":["../es6/create.js"],"names":["_","require","fastcall","ref","Dim4","assert","typedefs","module","exports","af","lib","_lib","intf","interface","declare","constant","_makeFunction","res","alloc","handleType","value","dims","type","af_constant","ndims","buffer","array","deref"],"mappings":"AAAA;;AACA,IAAMA,IAAIC,QAAQ,QAAR,CAAV;AACA,IAAMC,WAAWD,QAAQ,UAAR,CAAjB;AACA,IAAME,MAAMD,SAASC,GAArB;AACA,IAAMC,OAAOH,QAAQ,QAAR,CAAb;AACA,IAAMI,SAASJ,QAAQ,QAAR,CAAf;AACA,IAAMK,WAAWL,QAAQ,YAAR,CAAjB;;AAEAM,OAAOC,OAAP,GAAiB,UAAUC,EAAV,EAAc;AAC3B,QAAMC,MAAMD,GAAGE,IAAf;AACA,QAAMC,OAAOF,IAAIG,SAAjB;;AAEA;;AAEAH,QAAII,OAAJ,CAAY,oFAAZ;;AAEAL,OAAGM,QAAH,GAAcN,GAAGO,aAAH,CACV,YAAY;AACR,aAAKC,GAAL,GAAWd,IAAIe,KAAJ,CAAUZ,SAASa,UAAnB,CAAX;AACH,KAHS,EAIV,UAAUC,KAAV,EAAiBC,IAAjB,EAAiC;AAAA,YAAVC,IAAU,uEAAH,CAAG;;AAC7BjB,eAAOgB,gBAAgBjB,IAAvB,EAA6B,yCAA7B;AACA,eAAOQ,KAAKW,WAAL,CAAiB,KAAKN,GAAtB,EAA2BG,KAA3B,EAAkCC,KAAKG,KAAvC,EAA8CH,KAAKI,MAAnD,EAA2DH,IAA3D,CAAP;AACH,KAPS,EAQV,YAAY;AACR,eAAOb,GAAGiB,KAAH,CAASvB,IAAIwB,KAAJ,CAAU,KAAKV,GAAf,CAAT,CAAP;AACH,KAVS,CAAd;AAWH,CAnBD","file":"create.js","sourcesContent":["'use strict';\nconst _ = require('lodash');\nconst fastcall = require('fastcall');\nconst ref = fastcall.ref;\nconst Dim4 = require('./Dim4');\nconst assert = require('assert');\nconst typedefs = require('./typedefs');\n\nmodule.exports = function (af) {\n    const lib = af._lib;\n    const intf = lib.interface;\n\n    // constant\n\n    lib.declare('int af_constant(void** outArr, double value, uint ndims, longlong* dims, int type)');\n\n    af.constant = af._makeFunction(\n        function () {\n            this.res = ref.alloc(typedefs.handleType);\n        },\n        function (value, dims, type = 0) {\n            assert(dims instanceof Dim4, 'Argument \"dims\" is not a Dim4 instance.');\n            return intf.af_constant(this.res, value, dims.ndims, dims.buffer, type);\n        },\n        function () {\n            return af.array(ref.deref(this.res));\n        });\n};"]}